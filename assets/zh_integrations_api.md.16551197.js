import{_ as t}from"./chunks/web-create-api-token.013f57e0.js";import{_ as i,c as o,a as e,b as r,t as l,d as p,o as n}from"./app.15727171.js";const A=JSON.parse('{"title":"API","description":"","frontmatter":{"title":"API","editLink":true},"headers":[{"level":2,"title":"获取 API 令牌","slug":"获取-api-令牌","link":"#获取-api-令牌","children":[]},{"level":2,"title":"The GraphQL API","slug":"the-graphql-api","link":"#the-graphql-api","children":[{"level":3,"title":"常用方法","slug":"常用方法","link":"#常用方法","children":[]},{"level":3,"title":"使用 API 保存网址","slug":"使用-api-保存网址","link":"#使用-api-保存网址","children":[]}]},{"level":2,"title":"示例应用:","slug":"示例应用","link":"#示例应用","children":[]},{"level":2,"title":"保存来自浏览器的请求","slug":"保存来自浏览器的请求","link":"#保存来自浏览器的请求","children":[]}],"relativePath":"zh/integrations/api.md","lastUpdated":1685286019000}'),s={name:"zh/integrations/api.md"},c={id:"frontmatter-title",tabindex:"-1"},h=e("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),d=p('<nav class="table-of-contents"><ul><li><a href="#获取-api-令牌">获取 API 令牌</a></li><li><a href="#the-graphql-api">The GraphQL API</a><ul><li><a href="#常用方法">常用方法</a></li><li><a href="#使用-api-保存网址">使用 API 保存网址</a></li></ul></li><li><a href="#示例应用">示例应用:</a></li><li><a href="#保存来自浏览器的请求">保存来自浏览器的请求</a></li></ul></nav><p>Omnivore 公开了一个可以使用 API 令牌进行身份验证的 graphql API，这通常在从桌面、移动应用程序或本地计算机连接到 Omnivore 时使用。</p><p>Omnivore 的前端还会在 <a href="https://omnivore.app/api/save" target="_blank" rel="noreferrer">https://omnivore.app/api/save</a> 公开前端端点，以便在浏览器保存到文库中。此端点将使用您的浏览器 Cookie 进行身份验证。这通常用于与其他阅读器集成，如 <a href="https://www.inoreader.com/" target="_blank" rel="noreferrer">Inoreader</a>。</p><h2 id="获取-api-令牌" tabindex="-1">获取 API 令牌 <a class="header-anchor" href="#获取-api-令牌" aria-hidden="true">#</a></h2><ul><li>转到 <a href="https://omnivore.app/settings/api" target="_blank" rel="noreferrer">/settings/api</a></li><li>点击 <code>Create</code> <sup>（创建）</sup></li><li>为您的 API 密钥创建一个描述性名称</li><li>选择到期时间。当 API 密钥过期时，它将停止工作。</li><li>将 API 密钥复制到粘贴板。</li></ul><p><img src="'+t+`" alt="Creating an API token"></p><div class="tip custom-block"><p class="custom-block-title">创建 API 密钥后，您将无法再次访问其值。</p></div><p>您的 API 密钥应添加到 <code>Authorization</code> <sup>（授权）</sup> 标头中的请求中。下面是使用值为 <code>FFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF</code> 的 API 令牌的示例 GQL 请求：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl -X POST -d &#39;{ &quot;query&quot;: &quot;query Viewer { me { id name } }&quot; }&#39; -H &#39;content-type: application/json&#39; -H &#39;authorization: FFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF&#39; https://api-prod.omnivore.app/api/graphql</span></span>
<span class="line"><span style="color:#A6ACCD;">{&quot;data&quot;:{&quot;me&quot;:{&quot;id&quot;:&quot;&lt;your user id&gt;&quot;,&quot;name&quot;:&quot;&lt;your full name&gt;&quot;}}}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="the-graphql-api" tabindex="-1">The GraphQL API <a class="header-anchor" href="#the-graphql-api" aria-hidden="true">#</a></h2><p>参考文档不是为 GraphQL API创建的，但可以在 <a href="https://github.com/omnivore-app/omnivore/blob/main/packages/api/src/schema.ts" target="_blank" rel="noreferrer">GitHub</a>上访问该模式。</p><h3 id="常用方法" tabindex="-1">常用方法 <a class="header-anchor" href="#常用方法" aria-hidden="true">#</a></h3><ul><li><code>search</code>: 根据搜索词返回一组页面。使用空字符串获取所有页面。</li><li><code>article</code>: 获取单篇文章及其内容</li><li><code>saveUrl</code>: 保存网址</li><li><code>savePage</code>: 使用提供的 HTML 内容保存页面</li></ul><h3 id="使用-api-保存网址" tabindex="-1">使用 API 保存网址 <a class="header-anchor" href="#使用-api-保存网址" aria-hidden="true">#</a></h3><p>若要保存 URL，可以使用 <code>saveUrl</code> GQL 终结点，请注意有三个必需参数：</p><ul><li>url: 您要保存的网址，例如 <code>https://blog.omnivore.app/p/contributing-to-omnivore</code></li><li>clientRequestId: 此请求的唯一 ID。这可以使用 uuid 库生成，并用于在后续 API 调用中查找请求。例如： <code>85282635-4DF4-4BFC-A3D4-B3A004E57067</code></li><li>source: 将其设置为 <code>api</code> ，这有助于我们区分 URL 的保存方式。</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl -X POST -d &#39;{ &quot;query&quot;: &quot;mutation SaveUrl($input: SaveUrlInput!) { saveUrl(input: $input) { ... on SaveSuccess { url clientRequestId } ... on SaveError { errorCodes message } } }&quot;, &quot;variables&quot;: { &quot;input&quot;: { &quot;clientRequestId&quot;: &quot;85282635-4DF4-4BFC-A3D4-B3A004E57067&quot;, &quot;source&quot;: &quot;api&quot;, &quot;url&quot;: &quot;https://blog.omnivore.app/p/contributing-to-omnivore&quot; }} }&#39; -H &#39;content-type: application/json&#39; -H &#39;authorization: &lt;your api key&gt;&#39; https://api-prod.omnivore.app/api/graphql</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="示例应用" tabindex="-1">示例应用: <a class="header-anchor" href="#示例应用" aria-hidden="true">#</a></h2><ul><li><a href="https://github.com/davidohlin/instapaper-to-omnivore-import" target="_blank" rel="noreferrer">omnivore-import</a>: 一个打字稿工具，用于导入以前从 Instapaper 导出的库 (用 TypeScript 编写)</li><li><a href="https://github.com/laurentkempe/omnivore-api-demo-csharp" target="_blank" rel="noreferrer">omnivore-api-demo-csharp</a>: 下载所有文章并以 Markdown 格式保存 (用 C# 编写)</li></ul><h2 id="保存来自浏览器的请求" tabindex="-1">保存来自浏览器的请求 <a class="header-anchor" href="#保存来自浏览器的请求" aria-hidden="true">#</a></h2><p>可以在浏览器中 <a href="https://omnivore.app/api/save" target="_blank" rel="noreferrer">https://omnivore.app/api/save</a> 向前端终结点发出请求。</p><p>使用此端点时，您的浏览器 Cookie 将用于对请求进行身份验证和授权。可以使用 <code>labels</code> 查询参数添加标签： <code>https://omnivore.app/api/save?url=&lt;the url&gt;&amp;labels=&lt;Label1&gt;&amp;labels=&lt;Label2&gt;&amp;labels=&lt;Label3&gt;</code> ，例如： <a href="https://omnivore.app/api/save?url=https://blog.omnivore.app/p/whats-new-in-omnivore&amp;labels=Reading1&amp;labels=Software" target="_blank" rel="noreferrer">https://omnivore.app/api/save?url=https://blog.omnivore.app/p/whats-new-in-omnivore&amp;labels=Reading1&amp;labels=Software</a></p>`,22);function u(a,m,F,v,g,q){return n(),o("div",null,[e("h1",c,[r(l(a.$frontmatter.title)+" ",1),h]),d])}const _=i(s,[["render",u]]);export{A as __pageData,_ as default};
